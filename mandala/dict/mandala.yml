##
## APX Autopilot project <http://docs.uavos.com>
##
## Copyright (c) 2003-2020, Aliaksei Stratsilatau <sa@uavos.com>
## All rights reserved
##
## This file is part of APX Shared Libraries.
##
## This program is free software: you can redistribute it and/or modify
## it under the terms of the GNU Lesser General Public License as published by
## the Free Software Foundation, either version 3 of the License, or
## (at your option) any later version.
##
## This program is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU Lesser General Public License for more details.
##
## You should have received a copy of the GNU Lesser General Public License
## along with this program. If not, see <http://www.gnu.org/licenses/>.
##
name: mandala
title: Mandala
descr: Vehicle state data structure.

# Parameters:
#
# name:   short name of class/struct
# title:  text title
# descr:  text description
# units:  text units of measure
# type:   data type
# suffix: make title from parent.title+suffix

# UID contains 4 levels of IDs (11 bits):
#
#   4  classes      2 bits  [sns, ctr, est, cmd]
#   2  types        1 bit   [nav, env]
#   16 subsystems   4 bits
#   16 fields       4 bits
uid_base: 0x0000
uid_bits:
  - 2
  - 1
  - 4
  - 4

# Data flow:
#
#   |sensors|  ->  |est|  ->  |cmd|  ->  |ctr|
#   |-----estimators---|
#                  |--navigators--|
#                             |--controllers-|
#                  |---------telemetry-------|
#                             |----uplink----|

# Parameters are inherited from parent by child fields
inheritance:
  - type
  - units

# defaults:
type: real

# 4 classes
content:
  - name: sns
    title: Sensors
    descr: Read only data sources, measured by sensors from physical parameters.
    content:
      - name: nav
        content: sns-nav
        title: Navigation
        descr: Sensors used for vehicle navigation and controls.
          Used as input for position and attitude estimators and
          for filters to supply aerodynamic controls.

      - name: env
        content: sns-env
        title: Environment
        descr: Environmental sensors.
          Data used as inputs for filters to estimate vehicle state
          and safety conditions.

  - name: ctr
    title: Controls
    descr: Controls for vehicle drives and servos.
      Published by regulators.
    content:
      - name: nav
        content: ctr-nav
        title: Navigation
        descr: Controls used for vehicle stabilization.
          Data published by controllers for aerodynamic controls.

      - name: env
        content: ctr-env
        title: Environment
        descr: Environmental controls.
          Data generated by internal logic.

  - name: est
    title: Estimators
    descr: Current vehicle state.
      Estimated values of sensors and current navigator status.
    content:
      - name: nav
        content: est-nav
        title: Navigation
        descr: Estimated data used for vehicle regulators.
          Filtered sensor data.

      - name: env
        content: est-env
        title: Environment
        descr: Processed data of current vehicle conditions.
          Can be overridden by GCS uplink.

  - name: cmd
    title: Commands
    descr: Commanded values.
      Received from the GCS or provided by navigator as commands for
      regulators.
    content:
      - name: nav
        content: cmd-nav
        title: Navigation
        descr: Commanded values generated by controllers.

      - name: env
        content: cmd-env
        title: System data identifiers
        descr: Special protocols and data wrappers.
        type: byte # void

